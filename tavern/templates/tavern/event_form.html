{% extends "tavern/base.html" %}

{% block javascript %}
{{ form.media }}
{% endblock %}
{% block content %}
<form action="" method="POST" class="form-horizontal">
{% csrf_token %}

    <fieldset>
          <legend>Event Form</legend>

    {% if form.non_field_errors %}
        {% for non_field_error in form.non_field_errors %}
            <div class="alert alert-danger">
                <button class="close" type="button" data-dismiss="alert">&times;</button>
                {{ non_field_error }}
            </div>
        {% endfor %}
    {% endif %}

          {% for field in form %}
            <div class="control-group">
              <label class="control-label" for="input01">{{ field.label_tag }}</label>
              <div class="controls">
                {{ field }}
              </div>

              {% if field.errors %}
               {% for error in field.errors %}
                 <div class="alert alert-info">
             {{ error }}
                 </div>
               {% endfor %}
              {% endif %}

            </div>
          {% endfor %}

      <br/>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Save changes</button>
            <button class="btn btn-danger" type="reset">Cancel</button>
          </div>

    </fieldset>

</form>
<script type="text/javascript">
    $(document).ready(function(){
        date = new Date()
        date.setDate(date.getDate() - 1)
       $("#id_starts_at_picker").data("DateTimePicker").setStartDate(date);
       $("#id_ends_at_picker").data("DateTimePicker").setStartDate(date);
        $("#id_starts_at_picker").change(function(){
            date_in_string = $("#id_starts_at").val();
            date_in_string = date_in_string.split("-")
            startyear = parseInt(date_in_string[0])
            startmonth = parseInt(date_in_string[1])
            startdate = parseInt(date_in_string[2])
            date.setFullYear(startyear, startmonth - 1, startdate - 1)
            $("#id_ends_at_picker").data("DateTimePicker").setStartDate(date);
        });

        $("#id_ends_at_picker").change(function(){
            date_in_string = $("#id_ends_at").val();
            start_date = new Date()
            start_date.setDate(start_date.getDate() - 1);
            end_date = new Date()
            date_in_string = date_in_string.split("-");
            endyear = parseInt(date_in_string[0]);
            endmonth = parseInt(date_in_string[1]);
            enddate = parseInt(date_in_string[2]);
            end_date.setFullYear(endyear, endmonth - 1, enddate);
            $("#id_starts_at_picker").data("DateTimePicker").setStartDate(start_date);
            $("#id_starts_at_picker").data("DateTimePicker").setEndDate(end_date);
        });
    });
</script>
{% endblock content%}
